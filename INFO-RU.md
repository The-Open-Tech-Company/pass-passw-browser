# TOTC Pass | Password Pass - Подробное описание функционала

## Обзор

**TOTC Pass | Password Pass** — это расширение для браузера Chrome/Edge, предназначенное для безопасного хранения и управления паролями. Расширение использует локальное шифрование с помощью PIN-кода и не передаёт данные на внешние серверы.

## Основные возможности

### 1. Безопасное хранение паролей

- **Локальное шифрование**: Все пароли шифруются с использованием алгоритма AES-GCM (256 бит)
- **PIN-код защита**: Доступ к паролям защищён PIN-кодом от 4 до 6 цифр
- **Локальное хранение**: Все данные хранятся только в браузере пользователя, без передачи на внешние серверы
- **Автоматическое шифрование**: Пароли автоматически шифруются при сохранении с использованием уникальной соли для каждого пароля

### 2. Автоматическое сохранение паролей

- **Автоопределение форм входа**: Расширение автоматически определяет формы входа на веб-сайтах
- **Умное распознавание полей**: Определяет поля для имени пользователя и пароля по различным признакам:
  - Тип поля (email, text, password)
  - Атрибуты name и id
  - Автозаполнение (autocomplete)
  - Расположение полей относительно друг друга
- **Сохранение при отправке формы**: Пароли сохраняются автоматически при отправке формы входа
- **Сохранение при клике на кнопки**: Отслеживание кликов на кнопки входа для сохранения паролей
- **Обработка динамических форм**: Поддержка форм, загружаемых динамически через JavaScript

### 3. Автоматическое заполнение форм

- **Автозаполнение одним кликом**: Заполнение форм входа через контекстное меню или автоматически
- **Выбор аккаунта**: Если для сайта сохранено несколько аккаунтов, отображается меню выбора
- **Защита PIN-кодом**: Перед заполнением требуется ввод PIN-кода
- **Модальное окно на странице**: Удобный ввод PIN-кода прямо на странице сайта
- **Поддержка сложных форм**: Работает с различными типами форм входа, включая SPA-приложения

### 4. Управление паролями

#### Попап расширения

- **Две вкладки**:
  - **Сохранённые**: Просмотр всех сохранённых паролей
  - **Текущий сайт**: Просмотр паролей только для текущего открытого сайта
- **Поиск**: Быстрый поиск паролей по домену, имени пользователя или URL
- **Просмотр паролей**: Возможность показать/скрыть пароль
- **Копирование**: Копирование пароля в буфер обмена одним кликом
- **Удаление**: Удаление отдельных паролей
- **Экспорт**: Экспорт всех паролей в зашифрованном JSON-файле
- **Очистка**: Удаление всех сохранённых паролей

#### Настройки расширения

- **Управление PIN-кодом**:
  - Установка PIN-кода при первом использовании (6-12 символов, должен содержать хотя бы одну цифру и одну букву)
  - Изменение существующего PIN-кода
  - Защита от брутфорса: блокировка после 5 неверных попыток
- **Настройки генератора паролей**:
  - Длина пароля: 8-128 символов (по умолчанию: 16)
  - Типы символов: заглавные буквы, строчные буквы, цифры, спецсимволы
  - Исключение похожих символов: избегание путаницы (0/O, 1/l/I)
  - Тестовая генерация: предпросмотр сгенерированных паролей
- **Индикатор силы пароля**:
  - Анализ силы в реальном времени при вводе/редактировании паролей
  - Цветовая индикация уровней силы: Очень слабый, Слабый, Средний, Сильный, Очень сильный
  - Рекомендации по улучшению силы пароля
  - Бейдж силы отображается в списке паролей
- **Категории и теги**:
  - Создание пользовательских категорий (Работа, Личное, Социальные сети и т.д.)
  - Присвоение категорий паролям
  - Добавление нескольких тегов к паролям
  - Фильтрация паролей по категории или тегу
  - Быстрое создание категорий из панели инструментов списка паролей
- **Поиск дубликатов**:
  - Поиск паролей, используемых на нескольких сайтах
  - Просмотр всех сайтов, где используется дублирующийся пароль
  - Предупреждения о безопасности и рекомендации
- **Выборочный контроль экспорта**:
  - Включение/отключение экспорта для отдельных паролей
  - Экспорт только паролей с разрешённым экспортом
  - Повышенная безопасность для чувствительных паролей
- **Белый список сайтов**:
  - Добавление сайтов, на которых расширение не будет работать
  - Поддержка подстановочных знаков (*.example.com)
  - Управление списком (добавление/удаление)
- **Сброс настроек**: Полный сброс всех настроек и паролей

### 5. Безопасность

#### Шифрование

- **Алгоритм**: AES-GCM с длиной ключа 256 бит
- **Производная ключа**: PBKDF2 с 100,000 итераций и SHA-256
- **Уникальная соль**: Каждый пароль шифруется с уникальной случайной солью
- **IV (Initialization Vector)**: Уникальный IV для каждого шифрования

#### Защита PIN-кода

- **Хеширование**: PIN-код хранится в виде SHA-256 хеша
- **Защита от брутфорса**: 
  - Максимум 5 попыток ввода
  - Блокировка на 15 минут после превышения лимита
  - Счётчик попыток сбрасывается при успешном вводе
- **Сессионный PIN**: PIN-код хранится в памяти только во время активной сессии
- **Автоматический таймаут**: PIN-код автоматически очищается из памяти через 5 минут неактивности

#### Защита данных

- **Локальное хранение**: Все данные хранятся в `chrome.storage.local`
- **Отсутствие передачи данных**: Никакие данные не передаются на внешние серверы
- **Белый список**: Возможность исключить определённые сайты из обработки

### 6. Технические особенности

#### Архитектура

- **Service Worker (background.js)**: Обработка сообщений, управление сессией PIN-кода, работа с хранилищем
- **Content Script (content.js)**: Интеграция со страницами, обнаружение форм, автозаполнение
- **Popup (popup.html/js)**: Интерфейс управления паролями
- **Options (options.html/js)**: Страница настроек расширения
- **Crypto Utils (crypto-utils.js)**: Функции шифрования и работы с PIN-кодом

#### Обработка форм

- **MutationObserver**: Отслеживание динамически добавляемых форм на странице
- **Обработчики событий**: Отслеживание submit, click, input, change событий
- **Кэширование паролей**: Временное кэширование введённых паролей для сохранения при клике на кнопки
- **Умное определение**: Множественные стратегии определения полей формы

#### Ожидающие пароли

- **Механизм pending passwords**: Если PIN-код не введён, пароли временно сохраняются
- **Автоматическое сохранение**: При вводе PIN-кода все ожидающие пароли автоматически сохраняются
- **Уведомления**: Информирование пользователя о необходимости ввода PIN-кода

### 7. Пользовательский интерфейс

#### Дизайн

- **Современный UI**: Чистый и минималистичный дизайн
- **Адаптивность**: Интерфейс адаптирован для различных размеров окон
- **Анимации**: Плавные переходы и анимации для улучшения UX
- **Иконки**: Визуальные индикаторы для различных действий

#### Модальные окна

- **PIN-модальное окно в попапе**: Для доступа к паролям
- **PIN-модальное окно на странице**: Для автозаполнения форм
- **Меню выбора аккаунта**: При наличии нескольких сохранённых аккаунтов

#### Уведомления

- **Chrome Notifications API**: Уведомления о сохранении паролей, ошибках, необходимости ввода PIN-кода
- **Визуальная обратная связь**: Сообщения об успешных операциях и ошибках

### 8. Генератор паролей

- **Настраиваемые параметры**: Настройка параметров генерации паролей
  - Длина: 8-128 символов
  - Типы символов: заглавные, строчные, цифры, спецсимволы
  - Опция исключения похожих символов
- **Несколько точек доступа**:
  - Кнопка в модальном окне добавления/редактирования пароля
  - Пункт контекстного меню на полях пароля
  - Тестовая генерация в настройках
- **Безопасная генерация**: Использует crypto.getRandomValues для криптографически безопасной случайности
- **Гарантированные типы символов**: Обеспечивает наличие хотя бы одного символа каждого выбранного типа

### 9. Проверка силы пароля

- **Анализ в реальном времени**: Анализирует силу пароля во время ввода
- **Оценка силы**: 10-балльная шкала на основе множества факторов:
  - Длина (8, 12, 16, 20+ символов)
  - Разнообразие символов (заглавные, строчные, цифры, спецсимволы)
  - Обнаружение паттернов (повторяющиеся символы, последовательности, распространённые слова)
- **Визуальные индикаторы**: Цветовая индикация уровней силы с прогресс-баром
- **Рекомендации**: До 3 предложений по улучшению силы пароля
- **Отображение в списке**: Бейдж силы показывается для каждого пароля в списке

### 10. Система категорий и тегов

- **Категории**: 
  - Создание пользовательских категорий для организации паролей
  - Присвоение одной категории на пароль
  - Фильтрация паролей по категории
  - Быстрое создание категорий из панели инструментов
- **Теги**:
  - Добавление нескольких тегов к паролям
  - Ввод тегов через запятую
  - Фильтрация паролей по тегу
  - Автоматическое управление списком тегов
- **Организация**: Улучшенное управление паролями через категоризацию

### 11. Обнаружение дублирующихся паролей

- **Автоматическое обнаружение**: Сканирует все сохранённые пароли на наличие дубликатов
- **Использование на нескольких сайтах**: Определяет пароли, используемые на нескольких сайтах
- **Предупреждения о безопасности**: Визуальные предупреждения о рисках безопасности
- **Рекомендации**: Предлагает заменить дублирующиеся пароли на уникальные
- **Подробный отчёт**: Показывает все сайты, где используется дублирующийся пароль

### 12. Контекстное меню

- **Интеграция с браузером**: Добавление пунктов "Заполнить форму входа" и "Сгенерировать пароль" в контекстное меню
- **Умная обработка**: Автоматическое определение и заполнение форм на странице
- **Генерация пароля**: Вставка сгенерированного пароля непосредственно в поля пароля

### 13. Экспорт и импорт

- **Экспорт паролей**: 
  - Формат: зашифрованный JSON
  - Защита: шифрование с использованием PIN-кода
  - Метаданные: версия, дата экспорта, информация о шифровании
  - Выборочный экспорт: экспортируются только пароли с разрешённым экспортом
- **Контроль экспорта**: 
  - Переключатель экспорта для отдельных паролей в списке паролей
  - Повышенная безопасность для чувствительных паролей
  - По умолчанию: экспорт разрешён для всех паролей
- **Безопасность экспорта**: Экспортированные данные можно расшифровать только с правильным PIN-кодом

### 14. Обработка ошибок

- **Валидация**: Проверка корректности ввода PIN-кода, доменов, данных
- **Обработка ошибок шифрования**: Корректная обработка ошибок при шифровании/расшифровке
- **Совместимость форматов**: Поддержка старых форматов зашифрованных данных
- **Логирование**: Подробное логирование ошибок для отладки

### 15. Производительность

- **Ленивая загрузка**: Пароли загружаются только при необходимости
- **Кэширование**: Кэширование данных для уменьшения обращений к хранилищу
- **Оптимизация DOM**: Эффективная работа с DOM через MutationObserver
- **Минимальное влияние**: Расширение не замедляет работу браузера

### 16. Совместимость

- **Chrome**: Полная поддержка Chrome (Manifest V3)
- **Edge**: Совместимость с Microsoft Edge
- **Все сайты**: Работает на всех веб-сайтах (кроме системных страниц браузера)
- **SPA-приложения**: Поддержка одностраничных приложений с динамическим контентом

## Безопасность и конфиденциальность

### Принципы безопасности

1. **Локальное хранение**: Все данные остаются на устройстве пользователя
2. **Сильное шифрование**: Использование современных криптографических алгоритмов
3. **Защита PIN-кода**: Множественные уровни защиты от несанкционированного доступа
4. **Минимальные разрешения**: Расширение запрашивает только необходимые разрешения
5. **Открытый исходный код**: Возможность аудита кода сообществом

### Рекомендации по использованию

- Используйте уникальный PIN-код, который не используется в других местах
- Регулярно экспортируйте пароли для резервного копирования
- Не делитесь своим PIN-кодом
- Используйте белый список для исключения сайтов, где не нужна работа расширения
- Регулярно проверяйте сохранённые пароли и удаляйте неиспользуемые

## Технические детали

### Алгоритмы шифрования

- **Симметричное шифрование**: AES-GCM 256 бит
- **Производная ключа**: PBKDF2 с SHA-256, 100,000 итераций
- **Длина соли**: 16 байт (128 бит)
- **Длина IV**: 12 байт (96 бит)

### Хранение данных

- **Формат**: JSON в chrome.storage.local
- **Структура**: 
  - `passwords`: объект с доменами и массивами паролей (включает category, tags, allowExport)
  - `pinHash`: SHA-256 хеш PIN-кода
  - `whitelist`: массив доменов в белом списке
  - `pendingPasswords`: временные пароли, ожидающие PIN-кода
  - `pinAttempts`: счётчик попыток ввода PIN-кода
  - `pinLockedUntil`: время до разблокировки PIN-кода
  - `passwordGeneratorSettings`: конфигурация генератора паролей
  - `passwordCategories`: массив пользовательских категорий
  - `passwordTags`: массив всех используемых тегов

### API расширения

- **Chrome Storage API**: Для хранения данных
- **Chrome Runtime API**: Для обмена сообщениями между компонентами
- **Chrome Tabs API**: Для получения информации о текущей вкладке
- **Chrome Notifications API**: Для уведомлений пользователя
- **Chrome Context Menus API**: Для контекстного меню
- **Web Crypto API**: Для криптографических операций

## Разработка и поддержка

### Версия

- **Текущая версия**: 2.1.0
- **Manifest Version**: 3

### Лицензия

Проект создан на основе open source и доступен под соответствующей лицензией.

### Репозиторий

GitHub: https://github.com/The-Open-Tech-Company/pass-passw-browser

---

**Создано TOTC на основе open source. 2025**

